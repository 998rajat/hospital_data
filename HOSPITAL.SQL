USE HOSPITAL_DATA_SET;
SELECT 
-- PATIENT COLUMNS
P.PATIENT_ID AS `PATIENT_PATIENT ID`,
P.NAME AS `PATIENT NAME`,
P.GENDER AS `PATIENT GENDER`,
P.WEIGHT AS `PATIENT WEIGHT`,
P.AGE AS `PATIENT AGE`,
P.BLOOD_GROUP AS `PATIENT BLOOD GROUP`,
P.EMAIL AS `PATIENT EMAIL`,
P.ADMISSION_DATE AS `PATIENT ADMISSION DATE`,
P.DISCHARGE_DATE AS `PATIENT DISCHARGE DATE`,
P.ADDRESS AS `PATIENT ADDRESS`,
P.STATUS AS `PATIENT STATUS`,
CASE 
WHEN B.BED_ID IS NULL THEN "DISCGARGE"
ELSE "ADMITTED"
END AS `PATIENT ADMIISION STATUS`,
-- DOCTORS COLUMN 
DR.DOCTOR_ID AS `DOCTOR_ DOCTOR ID`,
DR.NAME AS `DOCTOR NAME`,
DR.SALARY AS `DOCTOR SALARY`,
DR.SPECIALIZATION AS `DOCTOR SPECIALIZATION`,
DR.DEPARTMENT AS `DOCTOR DEPARTMENT`,
DR.AVAILABILITY AS `DOCTOR AVAILABILITY`,
DR.JOINING_DATE AS `DOCTOR JOINING DATE`,
DR.QUALIFICATION AS `DOCTOR QUALIFICATION`,
DR.EXPERIENCE_YEARS AS `DOCTOR EXPERIENCE YEARS`,
DR.EMAIL AS `DOCTOR EMAIL`,
DR.PHONE AS `DOCTOR PHONE`,
-- BEDS COLUMN 
B.BED_ID AS `BED_ BED ID`,
B.OCCUPIED_FROM AS `BED OCCUPIED FROM`,
B.OCCUPIED_TILL AS `BEDS OCCUPIED TILL`,
B.STATUS AS `BED STATUS`,
-- ROOMS COLUMN
R.ROOM_ID AS `ROOM_ ROOM ID`,
R.FLOOR AS `ROOM FLOOR`,
R.ROOM_TYPE AS `ROOM TYPE`,
R.CAPACITY AS `ROOM CAPACITY`,
R.DAILY_CHARGE AS `ROOM DAILY CHARGE`,
R.`AVG MONTLY MAINTENANCE COST` AS `ROOM AVG MONTLY MAINTENANCE COST`,
R.STATUS AS `ROOM STATUS`,
-- DEPARTMENT COLUMN 
D.DEPARTMENT_ID AS `DEPARTEMENT_DEPARTEMENT ID`,
D.NAME AS `DEPARTMENT NAME`,
D.TOTAL_STAFF AS `DEPARTMENT TOTAL STAFF`,
-- SATISFACTION SCORE COLUMN
S.SATISFACTION_ID AS `SATISFACTION _ SATISFACTION ID`,
S.RATING AS `SATISFACTION RATING`,
S.FEEDBACK AS `SATISFACTION FEEDBACK`,
-- SURGERY COLUMN 
SUR.APPOINTMENT_ID AS `SURGERY_APPOINTMENT ID`,
SUR.APPOINTMENT_DATE AS `SURGERY APPOINTMENT DATE`,
SUR.APPOINTMENT_TIME AS `SURGERY APPOINTMENT TIME`,
 SUR.STATUS AS `SURGERY STATUS`,
 SUR. REASON AS `SURGERY REASON`,
 SUR.NOTES AS `SURGERY AS NOTES`,
 -- bills column
 HB.ROOM_CHARGES AS `HOSPITAL BED ROOM CHARGES`, 
 HB.SURGERY_CHARGES AS `SURGERY CHARGES`,
 HB.MEDICINE_CHARGES AS `MEDICINE CHARGES`,
 HB.TEST_CHARGES AS `TEST CHARGES`,
 HB.DOCTOR_FEES AS`DOCTOR FEES`,
 HB.TOTAL_AMOUNT AS `HOSPITAL BILL TOTAL AMOUNT`,
 HB.DISCOUNT AS `HOSPITAL BILL DISCOUNT`,
 HB.PAID_AMOUNT AS `HOSPITAL BILL PAID AMOUNT`,
 HB.PAYMENT_METHOD AS `BILL PAYMENT METHOD`,
 HB.PAYMENT_STATUS AS `BILL PAYMENT STATUS`
FROM PATIENT P 
LEFT JOIN `SATISFACTION SCORE` S 
ON P.PATIENT_ID = S.PATIENT_ID 
LEFT JOIN SURGERY SUR
ON SUR.PATIENT_ID = P.PATIENT_ID
LEFT JOIN `HOSPITAL BILLS` HB
ON HB.PATIENT_ID = P.PATIENT_ID
LEFT JOIN BEDS B
ON B.PATIENT_ID = P.PATIENT_ID
LEFT JOIN ROOMS R
ON R.ROOM_ID = B.ROOM_ID
LEFT JOIN DEPARTMENT D
ON D.DEPARTMENT_ID = R.DEPARTMENT_ID
LEFT JOIN (SELECT DISTINCT PATIENT_ID,DOCTOR_ID FROM APPOINTMENT) A
ON A.PATIENT_ID = P.PATIENT_ID
LEFT JOIN DOCTOR DR
ON DR.DOCTOR_ID = A.DOCTOR_ID;